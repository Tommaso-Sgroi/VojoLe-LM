Loading python/3.11.7
  Loading requirement: bzip2/1.0.8-ib3znej libmd/1.0.4-2km2lxx
    libbsd/0.12.1-oocs6an expat/2.6.2-p2t4wry ncurses/6.5-svfl57u
    readline/8.2-zeda6mx gdbm/1.23-wiol7vk libiconv/1.17-nhc3mhm
    xz/5.4.6-xxxg42c zlib-ng/2.1.6-jkgunjc libxml2/2.10.3-zbbe7lm
    pigz/2.8-5bwzpml zstd/1.5.6-uq5yyux tar/1.34-jgektnv gettext/0.22.5-hsxgafg
    libffi/3.4.6-4vs4jpp libxcrypt/4.4.35-7om46b5 sqlite/3.43.2-4kl5mnp
    util-linux-uuid/2.38.1-5achpds
Loading gcc/12.2.0
  Loading requirement: binutils/2.42
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2024 NVIDIA Corporation
Built on Thu_Mar_28_02:18:24_PDT_2024
Cuda compilation tools, release 12.4, V12.4.131
Build cuda_12.4.r12.4/compiler.34097967_0
INFO 08-06 21:44:23 [__init__.py:241] Automatically detected platform cuda.

==================== Job Configuration ====================
Model path         : /leonardo_scratch/fast/try25_sgroi/models/c4ai
Dataset path       : /leonardo_scratch/fast/try25_sgroi/datasets/mc4_it
Prompt path        : /leonardo_work/try25_sgroi/VojoLe-LM/generation_prompt4.txt
ITA DB path        : /leonardo_work/try25_sgroi/VojoLe-LM/er-italiano.db
SOR DB path        : /leonardo_work/try25_sgroi/VojoLe-LM/er-sorianese.db
Batch size         : 5
Max context tokens : 60000
GPUs               : 4
============================================================

INFO 08-06 21:44:53 [utils.py:326] non-default args: {'model': '/leonardo_scratch/fast/try25_sgroi/models/c4ai', 'dtype': 'bfloat16', 'max_model_len': 60000, 'tensor_parallel_size': 4, 'max_num_seqs': 5, 'disable_log_stats': True}
INFO 08-06 21:45:17 [config.py:713] Resolved architecture: Cohere2ForCausalLM
INFO 08-06 21:45:17 [config.py:1719] Using max model len 60000
INFO 08-06 21:45:22 [config.py:2545] Chunked prefill is enabled with max_num_batched_tokens=8192.
INFO 08-06 21:45:25 [core.py:605] Waiting for init message from front-end.
INFO 08-06 21:45:25 [core.py:73] Initializing a V1 LLM engine (v0.10.1.dev250+g6e672daf6) with config: model='/leonardo_scratch/fast/try25_sgroi/models/c4ai', speculative_config=None, tokenizer='/leonardo_scratch/fast/try25_sgroi/models/c4ai', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config={}, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=60000, download_dir=None, load_format=auto, tensor_parallel_size=4, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, decoding_config=DecodingConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_backend=''), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None), seed=0, served_model_name=/leonardo_scratch/fast/try25_sgroi/models/c4ai, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, pooler_config=None, compilation_config={"level":3,"debug_dump_path":"","cache_dir":"","backend":"","custom_ops":[],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output","vllm.mamba_mixer2"],"use_inductor":true,"compile_sizes":[],"inductor_compile_config":{"enable_auto_functionalized_v2":false},"inductor_passes":{},"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[8,4,2,1],"cudagraph_copy_inputs":false,"full_cuda_graph":false,"max_capture_size":8,"local_cache_dir":null}
INFO 08-06 21:45:25 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0, 1, 2, 3], buffer_handle=(4, 16777216, 10, 'psm_9c6db88a'), local_subscribe_addr='ipc:///tmp/4bcb3e2c-155c-47ed-9332-2432952a96f7', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:45:42 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_60e29557'), local_subscribe_addr='ipc:///tmp/fc07facd-6288-4392-9d60-152990f234be', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:45:42 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_2bc99aa0'), local_subscribe_addr='ipc:///tmp/394b0048-6e36-4f61-9ba3-38122e19cee0', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:45:42 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_6796769b'), local_subscribe_addr='ipc:///tmp/1140ff31-3fd2-440f-85b8-284cd44b4f67', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:45:42 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_83bed744'), local_subscribe_addr='ipc:///tmp/b417602a-b09a-4542-ae42-7e33135c5396', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:45:47 [__init__.py:1376] Found nccl from library libnccl.so.2
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:45:47 [pynccl.py:70] vLLM is using nccl==2.26.2
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:45:47 [__init__.py:1376] Found nccl from library libnccl.so.2
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:45:47 [pynccl.py:70] vLLM is using nccl==2.26.2
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:45:47 [__init__.py:1376] Found nccl from library libnccl.so.2
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:45:47 [pynccl.py:70] vLLM is using nccl==2.26.2
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:45:47 [__init__.py:1376] Found nccl from library libnccl.so.2
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:45:47 [pynccl.py:70] vLLM is using nccl==2.26.2
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:45:54 [custom_all_reduce.py:35] Skipping P2P check and trusting the driver's P2P report.
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:45:54 [custom_all_reduce.py:35] Skipping P2P check and trusting the driver's P2P report.
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:45:54 [custom_all_reduce.py:35] Skipping P2P check and trusting the driver's P2P report.
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:45:54 [custom_all_reduce.py:35] Skipping P2P check and trusting the driver's P2P report.
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:45:54 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[1, 2, 3], buffer_handle=(3, 4194304, 6, 'psm_5223ef30'), local_subscribe_addr='ipc:///tmp/68ad9381-ba27-40a1-ba6c-fc358d2fda50', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:45:54 [parallel_state.py:1102] rank 2 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 2, EP rank 2
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:45:54 [parallel_state.py:1102] rank 3 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 3, EP rank 3
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:45:54 [parallel_state.py:1102] rank 1 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 1, EP rank 1
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:45:54 [parallel_state.py:1102] rank 0 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 0, EP rank 0
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:45:54 [topk_topp_sampler.py:49] Using FlashInfer for top-p & top-k sampling.
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:45:54 [topk_topp_sampler.py:49] Using FlashInfer for top-p & top-k sampling.
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:45:54 [topk_topp_sampler.py:49] Using FlashInfer for top-p & top-k sampling.
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:45:54 [topk_topp_sampler.py:49] Using FlashInfer for top-p & top-k sampling.
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:45:54 [gpu_model_runner.py:1929] Starting to load model /leonardo_scratch/fast/try25_sgroi/models/c4ai...
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:45:54 [gpu_model_runner.py:1929] Starting to load model /leonardo_scratch/fast/try25_sgroi/models/c4ai...
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:45:54 [gpu_model_runner.py:1929] Starting to load model /leonardo_scratch/fast/try25_sgroi/models/c4ai...
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:45:54 [gpu_model_runner.py:1929] Starting to load model /leonardo_scratch/fast/try25_sgroi/models/c4ai...
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:45:55 [gpu_model_runner.py:1961] Loading model from scratch...
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:45:55 [gpu_model_runner.py:1961] Loading model from scratch...
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:45:55 [gpu_model_runner.py:1961] Loading model from scratch...
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:45:55 [gpu_model_runner.py:1961] Loading model from scratch...
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:45:57 [cuda.py:305] Using Flash Attention backend on V1 engine.
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:45:57 [cuda.py:305] Using Flash Attention backend on V1 engine.
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:45:57 [cuda.py:305] Using Flash Attention backend on V1 engine.
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:45:57 [cuda.py:305] Using Flash Attention backend on V1 engine.
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:49:31 [default_loader.py:262] Loading weights took 212.57 seconds
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:49:31 [default_loader.py:262] Loading weights took 212.60 seconds
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:49:31 [default_loader.py:262] Loading weights took 212.64 seconds
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:49:31 [default_loader.py:262] Loading weights took 212.65 seconds
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:49:34 [gpu_model_runner.py:1978] Model loading took 51.7478 GiB and 215.638586 seconds
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:49:34 [gpu_model_runner.py:1978] Model loading took 51.7478 GiB and 215.757878 seconds
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:49:34 [gpu_model_runner.py:1978] Model loading took 51.7478 GiB and 215.762025 seconds
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:49:34 [gpu_model_runner.py:1978] Model loading took 51.7478 GiB and 215.789557 seconds
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:50:58 [backends.py:530] Using cache directory: /leonardo/home/userexternal/tsgroi00/.cache/vllm/torch_compile_cache/a86e17a78e/rank_2_0/backbone for vLLM's torch.compile
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:50:58 [backends.py:530] Using cache directory: /leonardo/home/userexternal/tsgroi00/.cache/vllm/torch_compile_cache/a86e17a78e/rank_0_0/backbone for vLLM's torch.compile
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:50:58 [backends.py:530] Using cache directory: /leonardo/home/userexternal/tsgroi00/.cache/vllm/torch_compile_cache/a86e17a78e/rank_3_0/backbone for vLLM's torch.compile
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:50:58 [backends.py:541] Dynamo bytecode transform time: 82.49 s
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:50:58 [backends.py:541] Dynamo bytecode transform time: 82.50 s
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:50:58 [backends.py:530] Using cache directory: /leonardo/home/userexternal/tsgroi00/.cache/vllm/torch_compile_cache/a86e17a78e/rank_1_0/backbone for vLLM's torch.compile
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:50:58 [backends.py:541] Dynamo bytecode transform time: 82.51 s
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:50:58 [backends.py:541] Dynamo bytecode transform time: 82.51 s
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:51:19 [backends.py:194] Cache the graph for dynamic shape for later use
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:51:19 [backends.py:194] Cache the graph for dynamic shape for later use
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:51:19 [backends.py:194] Cache the graph for dynamic shape for later use
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:51:19 [backends.py:194] Cache the graph for dynamic shape for later use
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:54:27 [backends.py:215] Compiling a graph for dynamic shape takes 206.35 s
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:54:27 [backends.py:215] Compiling a graph for dynamic shape takes 206.36 s
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:54:28 [backends.py:215] Compiling a graph for dynamic shape takes 206.91 s
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:54:28 [backends.py:215] Compiling a graph for dynamic shape takes 207.34 s
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:55:02 [monitor.py:34] torch.compile takes 289.41 s in total
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:55:02 [monitor.py:34] torch.compile takes 289.85 s in total
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:55:02 [monitor.py:34] torch.compile takes 288.86 s in total
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:55:02 [monitor.py:34] torch.compile takes 288.86 s in total
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:55:12 [gpu_worker.py:276] Available KV cache memory: 2.20 GiB
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:55:12 [gpu_worker.py:276] Available KV cache memory: 2.34 GiB
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:55:12 [gpu_worker.py:276] Available KV cache memory: 2.34 GiB
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:55:12 [gpu_worker.py:276] Available KV cache memory: 2.20 GiB
INFO 08-06 21:55:14 [kv_cache_utils.py:995] GPU KV cache size: 38,368 tokens
INFO 08-06 21:55:14 [kv_cache_utils.py:999] Maximum concurrency for 60,000 tokens per request: 1.58x
INFO 08-06 21:55:14 [kv_cache_utils.py:995] GPU KV cache size: 36,064 tokens
INFO 08-06 21:55:14 [kv_cache_utils.py:999] Maximum concurrency for 60,000 tokens per request: 1.49x
INFO 08-06 21:55:14 [kv_cache_utils.py:995] GPU KV cache size: 36,064 tokens
INFO 08-06 21:55:14 [kv_cache_utils.py:999] Maximum concurrency for 60,000 tokens per request: 1.49x
INFO 08-06 21:55:14 [kv_cache_utils.py:995] GPU KV cache size: 38,368 tokens
INFO 08-06 21:55:14 [kv_cache_utils.py:999] Maximum concurrency for 60,000 tokens per request: 1.58x
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:55:18 [custom_all_reduce.py:196] Registering 516 cuda graph addresses
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:55:18 [custom_all_reduce.py:196] Registering 516 cuda graph addresses
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:55:18 [custom_all_reduce.py:196] Registering 516 cuda graph addresses
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:55:18 [custom_all_reduce.py:196] Registering 516 cuda graph addresses
[1;36m(VllmWorker rank=1 pid=3489377)[0;0m INFO 08-06 21:55:19 [gpu_model_runner.py:2583] Graph capturing finished in 5 secs, took 0.28 GiB
[1;36m(VllmWorker rank=3 pid=3489381)[0;0m INFO 08-06 21:55:19 [gpu_model_runner.py:2583] Graph capturing finished in 5 secs, took 0.28 GiB
[1;36m(VllmWorker rank=0 pid=3489375)[0;0m INFO 08-06 21:55:19 [gpu_model_runner.py:2583] Graph capturing finished in 5 secs, took 0.28 GiB
[1;36m(VllmWorker rank=2 pid=3489379)[0;0m INFO 08-06 21:55:19 [gpu_model_runner.py:2583] Graph capturing finished in 5 secs, took 0.28 GiB
INFO 08-06 21:55:19 [core.py:201] init engine (profile, create kv cache, warmup model) took 344.69 seconds
INFO 08-06 21:55:24 [llm.py:290] Supported_tasks: ['generate']
