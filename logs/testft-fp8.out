Loading python/3.11.7
  Loading requirement: bzip2/1.0.8-ib3znej libmd/1.0.4-2km2lxx
    libbsd/0.12.1-oocs6an expat/2.6.2-p2t4wry ncurses/6.5-svfl57u
    readline/8.2-zeda6mx gdbm/1.23-wiol7vk libiconv/1.17-nhc3mhm
    xz/5.4.6-xxxg42c zlib-ng/2.1.6-jkgunjc libxml2/2.10.3-zbbe7lm
    pigz/2.8-5bwzpml zstd/1.5.6-uq5yyux tar/1.34-jgektnv gettext/0.22.5-hsxgafg
    libffi/3.4.6-4vs4jpp libxcrypt/4.4.35-7om46b5 sqlite/3.43.2-4kl5mnp
    util-linux-uuid/2.38.1-5achpds
Loading gcc/12.2.0
  Loading requirement: binutils/2.42
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2024 NVIDIA Corporation
Built on Thu_Mar_28_02:18:24_PDT_2024
Cuda compilation tools, release 12.4, V12.4.131
Build cuda_12.4.r12.4/compiler.34097967_0
INFO 08-09 02:30:14 [__init__.py:241] Automatically detected platform cuda.

==================== Job Configuration ====================
Model path         : /leonardo_scratch/fast/try25_sgroi/models/c4ai
Dataset path       : /leonardo_scratch/fast/try25_sgroi/datasets/mc4_it
Prompt path        : /leonardo_work/try25_sgroi/VojoLe-LM/generation_prompt4.txt
ITA DB path        : /leonardo_work/try25_sgroi/VojoLe-LM/er-italiano-fp8.db
SOR DB path        : /leonardo_work/try25_sgroi/VojoLe-LM/er-sorianese-fp8.db
Batch size         : 14
Max context tokens : 31800
GPUs               : 4
Quantization       : fp8
============================================================

INFO 08-09 02:30:26 [utils.py:326] non-default args: {'model': '/leonardo_scratch/fast/try25_sgroi/models/c4ai', 'dtype': 'bfloat16', 'max_model_len': 31800, 'tensor_parallel_size': 4, 'max_num_seqs': 14, 'disable_log_stats': True, 'quantization': 'fp8'}
INFO 08-09 02:30:49 [config.py:713] Resolved architecture: Cohere2ForCausalLM
INFO 08-09 02:30:49 [config.py:1719] Using max model len 31800
INFO 08-09 02:30:54 [config.py:2545] Chunked prefill is enabled with max_num_batched_tokens=8192.
INFO 08-09 02:30:59 [core.py:605] Waiting for init message from front-end.
INFO 08-09 02:30:59 [core.py:73] Initializing a V1 LLM engine (v0.10.1.dev250+g6e672daf6) with config: model='/leonardo_scratch/fast/try25_sgroi/models/c4ai', speculative_config=None, tokenizer='/leonardo_scratch/fast/try25_sgroi/models/c4ai', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config={}, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=31800, download_dir=None, load_format=auto, tensor_parallel_size=4, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=fp8, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, decoding_config=DecodingConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_backend=''), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None), seed=0, served_model_name=/leonardo_scratch/fast/try25_sgroi/models/c4ai, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, pooler_config=None, compilation_config={"level":3,"debug_dump_path":"","cache_dir":"","backend":"","custom_ops":[],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output","vllm.mamba_mixer2"],"use_inductor":true,"compile_sizes":[],"inductor_compile_config":{"enable_auto_functionalized_v2":false},"inductor_passes":{},"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[24,16,8,4,2,1],"cudagraph_copy_inputs":false,"full_cuda_graph":false,"max_capture_size":24,"local_cache_dir":null}
INFO 08-09 02:30:59 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0, 1, 2, 3], buffer_handle=(4, 16777216, 10, 'psm_11102015'), local_subscribe_addr='ipc:///tmp/dac42990-4f83-4ba0-bf79-6936688b9b89', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:31:12 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_b4eb116a'), local_subscribe_addr='ipc:///tmp/7e1c86ae-ab8f-4341-b0ff-69f89dbf1a11', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:31:12 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_5c1496bd'), local_subscribe_addr='ipc:///tmp/280647fb-701e-4dbb-83ad-00740ed30b9c', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:31:12 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_004713cf'), local_subscribe_addr='ipc:///tmp/a40f3880-6352-43e1-84e8-4014040d9b03', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:31:12 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_6b259e33'), local_subscribe_addr='ipc:///tmp/a09df76e-31b1-4ec6-9a56-eacd3081910c', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:31:17 [__init__.py:1376] Found nccl from library libnccl.so.2
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:31:17 [pynccl.py:70] vLLM is using nccl==2.26.2
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:31:17 [__init__.py:1376] Found nccl from library libnccl.so.2
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:31:17 [pynccl.py:70] vLLM is using nccl==2.26.2
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:31:17 [__init__.py:1376] Found nccl from library libnccl.so.2
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:31:17 [pynccl.py:70] vLLM is using nccl==2.26.2
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:31:17 [__init__.py:1376] Found nccl from library libnccl.so.2
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:31:17 [pynccl.py:70] vLLM is using nccl==2.26.2
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:31:24 [custom_all_reduce.py:35] Skipping P2P check and trusting the driver's P2P report.
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:31:24 [custom_all_reduce.py:35] Skipping P2P check and trusting the driver's P2P report.
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:31:24 [custom_all_reduce.py:35] Skipping P2P check and trusting the driver's P2P report.
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:31:24 [custom_all_reduce.py:35] Skipping P2P check and trusting the driver's P2P report.
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:31:25 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[1, 2, 3], buffer_handle=(3, 4194304, 6, 'psm_4b4eae42'), local_subscribe_addr='ipc:///tmp/19a0f3db-c785-4e09-8a1d-9beac343e8fc', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:31:25 [parallel_state.py:1102] rank 1 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 1, EP rank 1
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:31:25 [parallel_state.py:1102] rank 2 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 2, EP rank 2
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:31:25 [parallel_state.py:1102] rank 3 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 3, EP rank 3
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:31:25 [parallel_state.py:1102] rank 0 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 0, EP rank 0
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:31:25 [topk_topp_sampler.py:49] Using FlashInfer for top-p & top-k sampling.
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:31:25 [topk_topp_sampler.py:49] Using FlashInfer for top-p & top-k sampling.
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:31:25 [topk_topp_sampler.py:49] Using FlashInfer for top-p & top-k sampling.
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:31:25 [topk_topp_sampler.py:49] Using FlashInfer for top-p & top-k sampling.
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:31:25 [gpu_model_runner.py:1929] Starting to load model /leonardo_scratch/fast/try25_sgroi/models/c4ai...
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:31:25 [gpu_model_runner.py:1929] Starting to load model /leonardo_scratch/fast/try25_sgroi/models/c4ai...
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:31:25 [gpu_model_runner.py:1929] Starting to load model /leonardo_scratch/fast/try25_sgroi/models/c4ai...
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:31:25 [gpu_model_runner.py:1929] Starting to load model /leonardo_scratch/fast/try25_sgroi/models/c4ai...
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:31:26 [gpu_model_runner.py:1961] Loading model from scratch...
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:31:26 [gpu_model_runner.py:1961] Loading model from scratch...
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:31:26 [gpu_model_runner.py:1961] Loading model from scratch...
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:31:26 [gpu_model_runner.py:1961] Loading model from scratch...
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:31:28 [cuda.py:305] Using Flash Attention backend on V1 engine.
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:31:28 [cuda.py:305] Using Flash Attention backend on V1 engine.
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:31:28 [cuda.py:305] Using Flash Attention backend on V1 engine.
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:31:28 [cuda.py:305] Using Flash Attention backend on V1 engine.
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:34:55 [default_loader.py:262] Loading weights took 205.55 seconds
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:34:55 [default_loader.py:262] Loading weights took 205.60 seconds
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:34:55 [default_loader.py:262] Loading weights took 206.04 seconds
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:34:55 [default_loader.py:262] Loading weights took 206.11 seconds
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m WARNING 08-09 02:34:56 [marlin_utils_fp8.py:82] Your GPU does not have native support for FP8 computation but FP8 quantization is being used. Weight-only FP8 compression will be used leveraging the Marlin kernel. This may degrade performance for compute-heavy workloads.
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m WARNING 08-09 02:34:56 [marlin_utils_fp8.py:82] Your GPU does not have native support for FP8 computation but FP8 quantization is being used. Weight-only FP8 compression will be used leveraging the Marlin kernel. This may degrade performance for compute-heavy workloads.
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m WARNING 08-09 02:34:56 [marlin_utils_fp8.py:82] Your GPU does not have native support for FP8 computation but FP8 quantization is being used. Weight-only FP8 compression will be used leveraging the Marlin kernel. This may degrade performance for compute-heavy workloads.
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m WARNING 08-09 02:34:56 [marlin_utils_fp8.py:82] Your GPU does not have native support for FP8 computation but FP8 quantization is being used. Weight-only FP8 compression will be used leveraging the Marlin kernel. This may degrade performance for compute-heavy workloads.
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:35:02 [gpu_model_runner.py:1978] Model loading took 26.6285 GiB and 213.801138 seconds
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:35:02 [gpu_model_runner.py:1978] Model loading took 26.6285 GiB and 213.630236 seconds
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:35:02 [gpu_model_runner.py:1978] Model loading took 26.6285 GiB and 213.804401 seconds
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:35:02 [gpu_model_runner.py:1978] Model loading took 26.6285 GiB and 213.809126 seconds
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:36:32 [backends.py:530] Using cache directory: /leonardo/home/userexternal/tsgroi00/.cache/vllm/torch_compile_cache/21b85c6670/rank_3_0/backbone for vLLM's torch.compile
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:36:32 [backends.py:530] Using cache directory: /leonardo/home/userexternal/tsgroi00/.cache/vllm/torch_compile_cache/21b85c6670/rank_1_0/backbone for vLLM's torch.compile
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:36:32 [backends.py:530] Using cache directory: /leonardo/home/userexternal/tsgroi00/.cache/vllm/torch_compile_cache/21b85c6670/rank_2_0/backbone for vLLM's torch.compile
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:36:32 [backends.py:530] Using cache directory: /leonardo/home/userexternal/tsgroi00/.cache/vllm/torch_compile_cache/21b85c6670/rank_0_0/backbone for vLLM's torch.compile
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:36:32 [backends.py:541] Dynamo bytecode transform time: 88.38 s
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:36:32 [backends.py:541] Dynamo bytecode transform time: 88.38 s
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:36:32 [backends.py:541] Dynamo bytecode transform time: 88.38 s
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:36:32 [backends.py:541] Dynamo bytecode transform time: 88.39 s
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:37:22 [backends.py:161] Directly load the compiled graph(s) for dynamic shape from the cache, took 43.969 s
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:37:22 [backends.py:161] Directly load the compiled graph(s) for dynamic shape from the cache, took 43.974 s
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:37:22 [backends.py:161] Directly load the compiled graph(s) for dynamic shape from the cache, took 43.987 s
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:37:22 [backends.py:161] Directly load the compiled graph(s) for dynamic shape from the cache, took 44.200 s
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:37:36 [monitor.py:34] torch.compile takes 88.38 s in total
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:37:36 [monitor.py:34] torch.compile takes 88.38 s in total
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:37:36 [monitor.py:34] torch.compile takes 88.39 s in total
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:37:36 [monitor.py:34] torch.compile takes 88.38 s in total
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:37:49 [gpu_worker.py:276] Available KV cache memory: 27.69 GiB
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:37:49 [gpu_worker.py:276] Available KV cache memory: 27.69 GiB
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:37:49 [gpu_worker.py:276] Available KV cache memory: 27.55 GiB
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:37:49 [gpu_worker.py:276] Available KV cache memory: 27.55 GiB
INFO 08-09 02:37:51 [kv_cache_utils.py:995] GPU KV cache size: 453,632 tokens
INFO 08-09 02:37:51 [kv_cache_utils.py:999] Maximum concurrency for 31,800 tokens per request: 26.41x
INFO 08-09 02:37:51 [kv_cache_utils.py:995] GPU KV cache size: 451,328 tokens
INFO 08-09 02:37:51 [kv_cache_utils.py:999] Maximum concurrency for 31,800 tokens per request: 26.27x
INFO 08-09 02:37:51 [kv_cache_utils.py:995] GPU KV cache size: 451,328 tokens
INFO 08-09 02:37:51 [kv_cache_utils.py:999] Maximum concurrency for 31,800 tokens per request: 26.27x
INFO 08-09 02:37:51 [kv_cache_utils.py:995] GPU KV cache size: 453,632 tokens
INFO 08-09 02:37:51 [kv_cache_utils.py:999] Maximum concurrency for 31,800 tokens per request: 26.41x
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:37:55 [custom_all_reduce.py:196] Registering 774 cuda graph addresses
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:37:55 [custom_all_reduce.py:196] Registering 774 cuda graph addresses
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:37:55 [custom_all_reduce.py:196] Registering 774 cuda graph addresses
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:37:55 [custom_all_reduce.py:196] Registering 774 cuda graph addresses
[1;36m(VllmWorker rank=3 pid=2862889)[0;0m INFO 08-09 02:37:56 [gpu_model_runner.py:2583] Graph capturing finished in 4 secs, took 0.32 GiB
[1;36m(VllmWorker rank=2 pid=2862887)[0;0m INFO 08-09 02:37:56 [gpu_model_runner.py:2583] Graph capturing finished in 4 secs, took 0.32 GiB
[1;36m(VllmWorker rank=1 pid=2862884)[0;0m INFO 08-09 02:37:56 [gpu_model_runner.py:2583] Graph capturing finished in 4 secs, took 0.32 GiB
[1;36m(VllmWorker rank=0 pid=2862883)[0;0m INFO 08-09 02:37:56 [gpu_model_runner.py:2583] Graph capturing finished in 4 secs, took 0.32 GiB
INFO 08-09 02:37:56 [core.py:201] init engine (profile, create kv cache, warmup model) took 173.76 seconds
INFO 08-09 02:38:00 [llm.py:290] Supported_tasks: ['generate']
