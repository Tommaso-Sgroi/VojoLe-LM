Loading python/3.11.7
  Loading requirement: bzip2/1.0.8-ib3znej libmd/1.0.4-2km2lxx
    libbsd/0.12.1-oocs6an expat/2.6.2-p2t4wry ncurses/6.5-svfl57u
    readline/8.2-zeda6mx gdbm/1.23-wiol7vk libiconv/1.17-nhc3mhm
    xz/5.4.6-xxxg42c zlib-ng/2.1.6-jkgunjc libxml2/2.10.3-zbbe7lm
    pigz/2.8-5bwzpml zstd/1.5.6-uq5yyux tar/1.34-jgektnv gettext/0.22.5-hsxgafg
    libffi/3.4.6-4vs4jpp libxcrypt/4.4.35-7om46b5 sqlite/3.43.2-4kl5mnp
    util-linux-uuid/2.38.1-5achpds
Loading gcc/12.2.0
  Loading requirement: binutils/2.42
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2024 NVIDIA Corporation
Built on Thu_Mar_28_02:18:24_PDT_2024
Cuda compilation tools, release 12.4, V12.4.131
Build cuda_12.4.r12.4/compiler.34097967_0
INFO 08-09 19:19:46 [__init__.py:241] Automatically detected platform cuda.

==================== Job Configuration ====================
Model path          : /leonardo_scratch/fast/try25_sgroi/models/c4ai
Dataset path        : /leonardo_scratch/fast/try25_sgroi/datasets/mc4_it
Prompt path         : /leonardo_work/try25_sgroi/VojoLe-LM/generation_prompt4.txt
ITA DB path         : /leonardo_scratch/fast/try25_sgroi/er-italiano.db
SOR DB path         : /leonardo_scratch/fast/try25_sgroi/er-sorianese.db
Batch size          : 5
Max context tokens  : 31800
GPUs                : 4
Generations x prompt: 3
Quantization        : None
============================================================

INFO 08-09 19:20:00 [utils.py:326] non-default args: {'model': '/leonardo_scratch/fast/try25_sgroi/models/c4ai', 'dtype': 'bfloat16', 'max_model_len': 31800, 'tensor_parallel_size': 4, 'max_num_seqs': 5, 'disable_log_stats': True}
INFO 08-09 19:20:22 [config.py:713] Resolved architecture: Cohere2ForCausalLM
INFO 08-09 19:20:22 [config.py:1719] Using max model len 31800
INFO 08-09 19:20:30 [config.py:2545] Chunked prefill is enabled with max_num_batched_tokens=8192.
INFO 08-09 19:20:33 [core.py:605] Waiting for init message from front-end.
INFO 08-09 19:20:33 [core.py:73] Initializing a V1 LLM engine (v0.10.1.dev250+g6e672daf6) with config: model='/leonardo_scratch/fast/try25_sgroi/models/c4ai', speculative_config=None, tokenizer='/leonardo_scratch/fast/try25_sgroi/models/c4ai', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config={}, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=31800, download_dir=None, load_format=auto, tensor_parallel_size=4, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, decoding_config=DecodingConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_backend=''), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None), seed=0, served_model_name=/leonardo_scratch/fast/try25_sgroi/models/c4ai, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, pooler_config=None, compilation_config={"level":3,"debug_dump_path":"","cache_dir":"","backend":"","custom_ops":[],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output","vllm.mamba_mixer2"],"use_inductor":true,"compile_sizes":[],"inductor_compile_config":{"enable_auto_functionalized_v2":false},"inductor_passes":{},"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[8,4,2,1],"cudagraph_copy_inputs":false,"full_cuda_graph":false,"max_capture_size":8,"local_cache_dir":null}
INFO 08-09 19:20:33 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0, 1, 2, 3], buffer_handle=(4, 16777216, 10, 'psm_60a25b85'), local_subscribe_addr='ipc:///tmp/5672fc70-f2ef-478f-9be7-d18d9dfaf7cc', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=2 pid=1433286)[0;0m INFO 08-09 19:21:16 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_b4dda973'), local_subscribe_addr='ipc:///tmp/852bc0f4-cf51-47d8-a094-d2759e6a3560', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=3 pid=1433290)[0;0m INFO 08-09 19:21:16 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_24bbe177'), local_subscribe_addr='ipc:///tmp/de245b4a-3245-4ec5-af2b-6baeb522bd73', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=0 pid=1433284)[0;0m INFO 08-09 19:21:16 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_569f9962'), local_subscribe_addr='ipc:///tmp/8ec632a3-451a-4d93-bbf5-bde2f0bb0175', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=1 pid=1433285)[0;0m INFO 08-09 19:21:16 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_daba0677'), local_subscribe_addr='ipc:///tmp/a6331ffa-284d-4eff-8741-8972aaccb184', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=3 pid=1433290)[0;0m INFO 08-09 19:21:20 [__init__.py:1376] Found nccl from library libnccl.so.2
[1;36m(VllmWorker rank=3 pid=1433290)[0;0m INFO 08-09 19:21:20 [pynccl.py:70] vLLM is using nccl==2.26.2
[1;36m(VllmWorker rank=1 pid=1433285)[0;0m INFO 08-09 19:21:20 [__init__.py:1376] Found nccl from library libnccl.so.2
[1;36m(VllmWorker rank=1 pid=1433285)[0;0m INFO 08-09 19:21:20 [pynccl.py:70] vLLM is using nccl==2.26.2
[1;36m(VllmWorker rank=2 pid=1433286)[0;0m INFO 08-09 19:21:20 [__init__.py:1376] Found nccl from library libnccl.so.2
[1;36m(VllmWorker rank=2 pid=1433286)[0;0m INFO 08-09 19:21:20 [pynccl.py:70] vLLM is using nccl==2.26.2
[1;36m(VllmWorker rank=0 pid=1433284)[0;0m INFO 08-09 19:21:20 [__init__.py:1376] Found nccl from library libnccl.so.2
[1;36m(VllmWorker rank=0 pid=1433284)[0;0m INFO 08-09 19:21:20 [pynccl.py:70] vLLM is using nccl==2.26.2
[1;36m(VllmWorker rank=0 pid=1433284)[0;0m INFO 08-09 19:21:27 [custom_all_reduce.py:35] Skipping P2P check and trusting the driver's P2P report.
[1;36m(VllmWorker rank=2 pid=1433286)[0;0m INFO 08-09 19:21:27 [custom_all_reduce.py:35] Skipping P2P check and trusting the driver's P2P report.
[1;36m(VllmWorker rank=1 pid=1433285)[0;0m INFO 08-09 19:21:27 [custom_all_reduce.py:35] Skipping P2P check and trusting the driver's P2P report.
[1;36m(VllmWorker rank=3 pid=1433290)[0;0m INFO 08-09 19:21:27 [custom_all_reduce.py:35] Skipping P2P check and trusting the driver's P2P report.
[1;36m(VllmWorker rank=0 pid=1433284)[0;0m INFO 08-09 19:21:27 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[1, 2, 3], buffer_handle=(3, 4194304, 6, 'psm_0c640848'), local_subscribe_addr='ipc:///tmp/717b759f-a7d5-4dd3-a9e0-f606ab5fb42c', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=0 pid=1433284)[0;0m INFO 08-09 19:21:27 [parallel_state.py:1102] rank 0 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 0, EP rank 0
[1;36m(VllmWorker rank=1 pid=1433285)[0;0m INFO 08-09 19:21:27 [parallel_state.py:1102] rank 1 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 1, EP rank 1
[1;36m(VllmWorker rank=2 pid=1433286)[0;0m INFO 08-09 19:21:27 [parallel_state.py:1102] rank 2 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 2, EP rank 2
[1;36m(VllmWorker rank=3 pid=1433290)[0;0m INFO 08-09 19:21:27 [parallel_state.py:1102] rank 3 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 3, EP rank 3
[1;36m(VllmWorker rank=3 pid=1433290)[0;0m INFO 08-09 19:21:27 [topk_topp_sampler.py:49] Using FlashInfer for top-p & top-k sampling.
[1;36m(VllmWorker rank=1 pid=1433285)[0;0m INFO 08-09 19:21:27 [topk_topp_sampler.py:49] Using FlashInfer for top-p & top-k sampling.
[1;36m(VllmWorker rank=0 pid=1433284)[0;0m INFO 08-09 19:21:27 [topk_topp_sampler.py:49] Using FlashInfer for top-p & top-k sampling.
[1;36m(VllmWorker rank=2 pid=1433286)[0;0m INFO 08-09 19:21:27 [topk_topp_sampler.py:49] Using FlashInfer for top-p & top-k sampling.
[1;36m(VllmWorker rank=3 pid=1433290)[0;0m INFO 08-09 19:21:28 [gpu_model_runner.py:1929] Starting to load model /leonardo_scratch/fast/try25_sgroi/models/c4ai...
[1;36m(VllmWorker rank=1 pid=1433285)[0;0m INFO 08-09 19:21:28 [gpu_model_runner.py:1929] Starting to load model /leonardo_scratch/fast/try25_sgroi/models/c4ai...
[1;36m(VllmWorker rank=2 pid=1433286)[0;0m INFO 08-09 19:21:28 [gpu_model_runner.py:1929] Starting to load model /leonardo_scratch/fast/try25_sgroi/models/c4ai...
[1;36m(VllmWorker rank=0 pid=1433284)[0;0m INFO 08-09 19:21:28 [gpu_model_runner.py:1929] Starting to load model /leonardo_scratch/fast/try25_sgroi/models/c4ai...
[1;36m(VllmWorker rank=1 pid=1433285)[0;0m INFO 08-09 19:21:28 [gpu_model_runner.py:1961] Loading model from scratch...
[1;36m(VllmWorker rank=2 pid=1433286)[0;0m INFO 08-09 19:21:28 [gpu_model_runner.py:1961] Loading model from scratch...
[1;36m(VllmWorker rank=3 pid=1433290)[0;0m INFO 08-09 19:21:28 [gpu_model_runner.py:1961] Loading model from scratch...
[1;36m(VllmWorker rank=0 pid=1433284)[0;0m INFO 08-09 19:21:29 [gpu_model_runner.py:1961] Loading model from scratch...
[1;36m(VllmWorker rank=0 pid=1433284)[0;0m INFO 08-09 19:21:31 [cuda.py:305] Using Flash Attention backend on V1 engine.
[1;36m(VllmWorker rank=1 pid=1433285)[0;0m INFO 08-09 19:21:31 [cuda.py:305] Using Flash Attention backend on V1 engine.
[1;36m(VllmWorker rank=3 pid=1433290)[0;0m INFO 08-09 19:21:31 [cuda.py:305] Using Flash Attention backend on V1 engine.
[1;36m(VllmWorker rank=2 pid=1433286)[0;0m INFO 08-09 19:21:31 [cuda.py:305] Using Flash Attention backend on V1 engine.
