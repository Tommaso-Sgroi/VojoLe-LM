Loading python/3.11.7
  Loading requirement: bzip2/1.0.8-ib3znej libmd/1.0.4-2km2lxx
    libbsd/0.12.1-oocs6an expat/2.6.2-p2t4wry ncurses/6.5-svfl57u
    readline/8.2-zeda6mx gdbm/1.23-wiol7vk libiconv/1.17-nhc3mhm
    xz/5.4.6-xxxg42c zlib-ng/2.1.6-jkgunjc libxml2/2.10.3-zbbe7lm
    pigz/2.8-5bwzpml zstd/1.5.6-uq5yyux tar/1.34-jgektnv gettext/0.22.5-hsxgafg
    libffi/3.4.6-4vs4jpp libxcrypt/4.4.35-7om46b5 sqlite/3.43.2-4kl5mnp
    util-linux-uuid/2.38.1-5achpds
Loading gcc/12.2.0
  Loading requirement: binutils/2.42
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2024 NVIDIA Corporation
Built on Thu_Mar_28_02:18:24_PDT_2024
Cuda compilation tools, release 12.4, V12.4.131
Build cuda_12.4.r12.4/compiler.34097967_0
INFO 08-01 21:46:04 [__init__.py:241] Automatically detected platform cuda.
INFO 08-01 21:46:33 [utils.py:326] non-default args: {'model': '/leonardo_scratch/fast/try25_sgroi/models/c4ai', 'dtype': 'bfloat16', 'max_model_len': 80000, 'tensor_parallel_size': 4, 'disable_log_stats': True}
INFO 08-01 21:46:57 [config.py:713] Resolved architecture: Cohere2ForCausalLM
INFO 08-01 21:46:57 [config.py:1719] Using max model len 80000
INFO 08-01 21:47:04 [config.py:2545] Chunked prefill is enabled with max_num_batched_tokens=8192.
INFO 08-01 21:47:06 [core.py:605] Waiting for init message from front-end.
INFO 08-01 21:47:06 [core.py:73] Initializing a V1 LLM engine (v0.10.1.dev250+g6e672daf6) with config: model='/leonardo_scratch/fast/try25_sgroi/models/c4ai', speculative_config=None, tokenizer='/leonardo_scratch/fast/try25_sgroi/models/c4ai', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config={}, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=80000, download_dir=None, load_format=auto, tensor_parallel_size=4, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, decoding_config=DecodingConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_backend=''), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None), seed=0, served_model_name=/leonardo_scratch/fast/try25_sgroi/models/c4ai, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, pooler_config=None, compilation_config={"level":3,"debug_dump_path":"","cache_dir":"","backend":"","custom_ops":[],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output","vllm.mamba_mixer2"],"use_inductor":true,"compile_sizes":[],"inductor_compile_config":{"enable_auto_functionalized_v2":false},"inductor_passes":{},"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"cudagraph_copy_inputs":false,"full_cuda_graph":false,"max_capture_size":512,"local_cache_dir":null}
INFO 08-01 21:47:06 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0, 1, 2, 3], buffer_handle=(4, 16777216, 10, 'psm_ce6fa8e3'), local_subscribe_addr='ipc:///tmp/70df42f5-d7fc-410b-9f97-5730ee6bf028', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:47:22 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_e30aa8bb'), local_subscribe_addr='ipc:///tmp/56510db5-099c-473d-898d-8b2d8512b471', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:47:22 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_902a290a'), local_subscribe_addr='ipc:///tmp/a7bea302-09d8-4b65-abcb-b0bc3a4f4249', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:47:22 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_1b53f589'), local_subscribe_addr='ipc:///tmp/e4048633-41b7-46a9-b0ca-dd7198f0bec0', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:47:22 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[0], buffer_handle=(1, 10485760, 10, 'psm_a43b7bda'), local_subscribe_addr='ipc:///tmp/ec0fa2d7-2204-45cf-83cc-d1658b9fccb9', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:47:28 [__init__.py:1376] Found nccl from library libnccl.so.2
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:47:28 [pynccl.py:70] vLLM is using nccl==2.26.2
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:47:28 [__init__.py:1376] Found nccl from library libnccl.so.2
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:47:28 [pynccl.py:70] vLLM is using nccl==2.26.2
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:47:28 [__init__.py:1376] Found nccl from library libnccl.so.2
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:47:28 [pynccl.py:70] vLLM is using nccl==2.26.2
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:47:28 [__init__.py:1376] Found nccl from library libnccl.so.2
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:47:28 [pynccl.py:70] vLLM is using nccl==2.26.2
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:47:35 [custom_all_reduce.py:35] Skipping P2P check and trusting the driver's P2P report.
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:47:35 [custom_all_reduce.py:35] Skipping P2P check and trusting the driver's P2P report.
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:47:35 [custom_all_reduce.py:35] Skipping P2P check and trusting the driver's P2P report.
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:47:35 [custom_all_reduce.py:35] Skipping P2P check and trusting the driver's P2P report.
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:47:35 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[1, 2, 3], buffer_handle=(3, 4194304, 6, 'psm_52e8a1b0'), local_subscribe_addr='ipc:///tmp/0ff55789-dac7-459f-be17-3d81ee0f8299', remote_subscribe_addr=None, remote_addr_ipv6=False)
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:47:35 [parallel_state.py:1102] rank 1 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 1, EP rank 1
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:47:35 [parallel_state.py:1102] rank 0 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 0, EP rank 0
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:47:35 [parallel_state.py:1102] rank 3 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 3, EP rank 3
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:47:35 [parallel_state.py:1102] rank 2 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 2, EP rank 2
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:47:36 [topk_topp_sampler.py:49] Using FlashInfer for top-p & top-k sampling.
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:47:36 [topk_topp_sampler.py:49] Using FlashInfer for top-p & top-k sampling.
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:47:36 [topk_topp_sampler.py:49] Using FlashInfer for top-p & top-k sampling.
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:47:36 [topk_topp_sampler.py:49] Using FlashInfer for top-p & top-k sampling.
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:47:36 [gpu_model_runner.py:1929] Starting to load model /leonardo_scratch/fast/try25_sgroi/models/c4ai...
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:47:36 [gpu_model_runner.py:1929] Starting to load model /leonardo_scratch/fast/try25_sgroi/models/c4ai...
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:47:36 [gpu_model_runner.py:1929] Starting to load model /leonardo_scratch/fast/try25_sgroi/models/c4ai...
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:47:36 [gpu_model_runner.py:1929] Starting to load model /leonardo_scratch/fast/try25_sgroi/models/c4ai...
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:47:37 [gpu_model_runner.py:1961] Loading model from scratch...
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:47:37 [gpu_model_runner.py:1961] Loading model from scratch...
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:47:37 [gpu_model_runner.py:1961] Loading model from scratch...
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:47:37 [gpu_model_runner.py:1961] Loading model from scratch...
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:47:39 [cuda.py:305] Using Flash Attention backend on V1 engine.
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:47:39 [cuda.py:305] Using Flash Attention backend on V1 engine.
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:47:39 [cuda.py:305] Using Flash Attention backend on V1 engine.
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:47:39 [cuda.py:305] Using Flash Attention backend on V1 engine.
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:51:09 [default_loader.py:262] Loading weights took 208.44 seconds
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:51:09 [default_loader.py:262] Loading weights took 208.49 seconds
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:51:09 [default_loader.py:262] Loading weights took 208.60 seconds
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:51:10 [default_loader.py:262] Loading weights took 209.23 seconds
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:51:12 [gpu_model_runner.py:1978] Model loading took 51.7478 GiB and 212.087786 seconds
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:51:12 [gpu_model_runner.py:1978] Model loading took 51.7478 GiB and 211.949369 seconds
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:51:12 [gpu_model_runner.py:1978] Model loading took 51.7478 GiB and 212.187663 seconds
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:51:12 [gpu_model_runner.py:1978] Model loading took 51.7478 GiB and 212.787670 seconds
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:52:35 [backends.py:530] Using cache directory: /leonardo/home/userexternal/tsgroi00/.cache/vllm/torch_compile_cache/d314cf8312/rank_0_0/backbone for vLLM's torch.compile
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:52:35 [backends.py:530] Using cache directory: /leonardo/home/userexternal/tsgroi00/.cache/vllm/torch_compile_cache/d314cf8312/rank_2_0/backbone for vLLM's torch.compile
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:52:35 [backends.py:541] Dynamo bytecode transform time: 82.25 s
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:52:35 [backends.py:530] Using cache directory: /leonardo/home/userexternal/tsgroi00/.cache/vllm/torch_compile_cache/d314cf8312/rank_1_0/backbone for vLLM's torch.compile
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:52:35 [backends.py:530] Using cache directory: /leonardo/home/userexternal/tsgroi00/.cache/vllm/torch_compile_cache/d314cf8312/rank_3_0/backbone for vLLM's torch.compile
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:52:35 [backends.py:541] Dynamo bytecode transform time: 82.26 s
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:52:35 [backends.py:541] Dynamo bytecode transform time: 82.26 s
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:52:35 [backends.py:541] Dynamo bytecode transform time: 82.27 s
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:52:56 [backends.py:194] Cache the graph for dynamic shape for later use
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:52:56 [backends.py:194] Cache the graph for dynamic shape for later use
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:52:56 [backends.py:194] Cache the graph for dynamic shape for later use
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:52:56 [backends.py:194] Cache the graph for dynamic shape for later use
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:56:02 [backends.py:215] Compiling a graph for dynamic shape takes 204.29 s
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:56:02 [backends.py:215] Compiling a graph for dynamic shape takes 204.34 s
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:56:03 [backends.py:215] Compiling a graph for dynamic shape takes 204.55 s
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:56:04 [backends.py:215] Compiling a graph for dynamic shape takes 205.81 s
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:56:38 [monitor.py:34] torch.compile takes 288.07 s in total
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:56:38 [monitor.py:34] torch.compile takes 286.61 s in total
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:56:38 [monitor.py:34] torch.compile takes 286.81 s in total
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:56:38 [monitor.py:34] torch.compile takes 286.54 s in total
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:56:48 [gpu_worker.py:276] Available KV cache memory: 2.34 GiB
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:56:48 [gpu_worker.py:276] Available KV cache memory: 2.20 GiB
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:56:48 [gpu_worker.py:276] Available KV cache memory: 2.20 GiB
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:56:48 [gpu_worker.py:276] Available KV cache memory: 2.34 GiB
INFO 08-01 21:56:50 [kv_cache_utils.py:995] GPU KV cache size: 38,368 tokens
INFO 08-01 21:56:50 [kv_cache_utils.py:999] Maximum concurrency for 80,000 tokens per request: 1.31x
INFO 08-01 21:56:50 [kv_cache_utils.py:995] GPU KV cache size: 36,064 tokens
INFO 08-01 21:56:50 [kv_cache_utils.py:999] Maximum concurrency for 80,000 tokens per request: 1.23x
INFO 08-01 21:56:50 [kv_cache_utils.py:995] GPU KV cache size: 36,064 tokens
INFO 08-01 21:56:50 [kv_cache_utils.py:999] Maximum concurrency for 80,000 tokens per request: 1.23x
INFO 08-01 21:56:50 [kv_cache_utils.py:995] GPU KV cache size: 38,368 tokens
INFO 08-01 21:56:50 [kv_cache_utils.py:999] Maximum concurrency for 80,000 tokens per request: 1.31x
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:57:25 [custom_all_reduce.py:196] Registering 5805 cuda graph addresses
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:57:25 [custom_all_reduce.py:196] Registering 5805 cuda graph addresses
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:57:25 [custom_all_reduce.py:196] Registering 5805 cuda graph addresses
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:57:25 [custom_all_reduce.py:196] Registering 5805 cuda graph addresses
[1;36m(VllmWorker rank=3 pid=157831)[0;0m INFO 08-01 21:57:26 [gpu_model_runner.py:2583] Graph capturing finished in 36 secs, took 3.65 GiB
[1;36m(VllmWorker rank=0 pid=157825)[0;0m INFO 08-01 21:57:26 [gpu_model_runner.py:2583] Graph capturing finished in 36 secs, took 3.65 GiB
[1;36m(VllmWorker rank=1 pid=157826)[0;0m INFO 08-01 21:57:26 [gpu_model_runner.py:2583] Graph capturing finished in 36 secs, took 3.65 GiB
[1;36m(VllmWorker rank=2 pid=157828)[0;0m INFO 08-01 21:57:26 [gpu_model_runner.py:2583] Graph capturing finished in 36 secs, took 3.65 GiB
INFO 08-01 21:57:26 [core.py:201] init engine (profile, create kv cache, warmup model) took 374.41 seconds
INFO 08-01 21:57:31 [llm.py:290] Supported_tasks: ['generate']

Generating!! EURECAAA

ERROR 08-01 21:57:34 [core_client.py:536] Engine core proc EngineCore_0 died unexpectedly, shutting down client.
